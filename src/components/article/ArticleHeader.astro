---
import { Badge } from "@/components/ui/badge";
import type { CollectionEntry } from "astro:content";

interface Props {
  entry: CollectionEntry<"articles">;
  showDescription?: boolean;
  /** Render tags as links. Set false when inside another link (e.g. article card) to avoid invalid nested anchors. */
  linkTags?: boolean;
  /** Use h3 instead of h1 (for article previews in lists/cards). */
  preview?: boolean;
}

const {
  entry,
  showDescription = false,
  linkTags = false,
  preview = false,
} = Astro.props;
const { title, date, tags, featured, description } = entry.data;

const formattedDate = new Intl.DateTimeFormat("en-GB", {
  dateStyle: "long",
}).format(date);
---

<header>
  <div class="flex flex-wrap items-center gap-2">
    {
      featured && (
        <Badge variant="secondary" className="text-xs">
          Featured
        </Badge>
      )
    }
    {
      linkTags
        ? tags.map((tag) => (
            <a href={`/tags/${tag}`} class="inline-block">
              <Badge variant="outline" className="text-xs">
                {tag}
              </Badge>
            </a>
          ))
        : tags.map((tag) => (
            <Badge variant="outline" className="text-xs">
              {tag}
            </Badge>
          ))
    }
  </div>
  {preview ? <h3 class="mt-2">{title}</h3> : <h1 class="mt-2">{title}</h1>}
  <time datetime={date.toISOString()} class="text-sm text-muted-foreground">
    {formattedDate}
  </time>
  {
    showDescription && description && (
      <p class="mt-2 text-sm text-muted-foreground">{description}</p>
    )
  }
</header>
